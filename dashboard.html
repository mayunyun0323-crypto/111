<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>个人中心 - CryptoCredit</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="dashboard.css">
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar">
        <div class="container navbar-content">
            <a href="index.html" class="logo">
                <span class="logo-icon">◈</span>
                <span class="logo-text">CryptoCredit</span>
            </a>
            <div class="navbar-right">
                <a href="borrow.html" class="nav-link" data-lang="borrow">借款</a>
                <a href="dashboard.html" class="nav-link active" data-lang="dashboard">个人中心</a>
                <div class="lang-switcher">
                    <button class="lang-btn active" data-lang-switch="zh" onclick="switchLanguage('zh')">中</button>
                    <button class="lang-btn" data-lang-switch="en" onclick="switchLanguage('en')">EN</button>
                </div>
                <button class="btn btn-outline" id="connectWallet">
                    <span class="wallet-icon">◉</span>
                    <span id="walletText" data-lang="connectWallet">连接钱包</span>
                </button>
            </div>
        </div>
    </nav>

    <!-- 黑名单警告横幅 -->
    <div class="blacklist-banner" id="blacklistBanner">
        <div class="container">
            <span class="banner-icon">!</span>
            <span class="banner-text" data-lang="blacklistBanner">
                您的账户已被列入黑名单，借款功能已禁用。请还清逾期借款后等待解除。
            </span>
        </div>
    </div>

    <!-- 主要内容 -->
    <main class="dashboard-page">
        <div class="container">
            <!-- 未连接钱包提示 -->
            <div class="connect-prompt" id="connectPrompt">
                <div class="prompt-card">
                    <div class="prompt-icon">◎</div>
                    <h2 data-lang="dashboardPromptTitle">查看您的借款记录</h2>
                    <p data-lang="dashboardPromptDesc">连接钱包后可查看借款状态、还款记录和信用报告</p>
                    <button class="btn btn-primary btn-large" id="promptConnectBtn" data-lang="connectWallet">
                        连接钱包
                    </button>
                </div>
            </div>

            <!-- 仪表盘主界面 -->
            <div class="dashboard-main" id="dashboardMain" style="display: none;">
                <!-- 待还款总额 -->
                <div class="total-debt-card">
                    <div class="debt-card-content">
                        <div class="debt-icon">$</div>
                        <div class="debt-info">
                            <span class="debt-label" data-lang="pendingRepay">当前待还款总额</span>
                            <span class="debt-value" id="pendingRepay">0 USDT</span>
                        </div>
                    </div>
                    <a href="borrow.html" class="btn btn-primary" data-lang="borrowNow">立即借款</a>
                </div>

                <!-- 还款历史 -->
                <div class="section-panel full-width">
                    <div class="panel-header">
                        <h3 class="panel-title" data-lang="loanHistory">借款历史</h3>
                        <div class="header-actions">
                            <select class="filter-select" id="historyFilter">
                                <option value="all" data-lang="filterAll">全部</option>
                                <option value="active" data-lang="filterActive">进行中</option>
                                <option value="repaid" data-lang="filterRepaid">已还款</option>
                                <option value="overdue" data-lang="filterOverdue">已逾期</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- 历史记录表格 -->
                    <div class="history-table-wrapper">
                        <table class="history-table">
                            <thead>
                                <tr>
                                    <th data-lang="tableId">借款编号</th>
                                    <th data-lang="tableAmount">借款金额</th>
                                    <th data-lang="tableBorrowDate">借款日期</th>
                                    <th data-lang="tableDueDate">到期日期</th>
                                    <th data-lang="tableInterest">利息</th>
                                    <th data-lang="tableStatus">状态</th>
                                    <th data-lang="tableAction">操作</th>
                                </tr>
                            </thead>
                            <tbody id="historyTableBody">
                                <!-- 通过 JS 动态生成 -->
                            </tbody>
                        </table>
                    </div>

                    <!-- 空状态 -->
                    <div class="empty-history" id="emptyHistory" style="display: none;">
                        <p>暂无借款记录</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- 还款弹窗 -->
    <div class="modal" id="repayModal">
        <div class="modal-overlay"></div>
        <div class="modal-content repay-modal">
            <div class="modal-header">
                <h3 class="modal-title" data-lang="repayConfirm">还款确认</h3>
                <button class="modal-close" id="repayModalClose">×</button>
            </div>
            <div class="modal-body">
                <!-- 借款信息 -->
                <div class="repay-info">
                    <div class="repay-row">
                        <span class="repay-label" data-lang="loanId">借款编号</span>
                        <span class="repay-value" id="repayLoanId">--</span>
                    </div>
                    <div class="repay-row">
                        <span class="repay-label" data-lang="principal">借款本金</span>
                        <span class="repay-value" id="repayPrincipal">-- USDT</span>
                    </div>
                    <div class="repay-row">
                        <span class="repay-label" data-lang="interest">借款利息</span>
                        <span class="repay-value" id="repayInterest">-- USDT</span>
                    </div>
                    <div class="repay-row">
                        <span class="repay-label" data-lang="penalty">滞纳金</span>
                        <span class="repay-value" id="repayPenalty">0 USDT</span>
                    </div>
                    <div class="repay-divider"></div>
                    <div class="repay-row total">
                        <span class="repay-label" data-lang="totalRepay">应还总额</span>
                        <span class="repay-value" id="repayTotal">-- USDT</span>
                    </div>
                </div>

                <!-- 还款方式选择 -->
                <div class="repay-type-section">
                    <label class="repay-type-label" data-lang="repayType">还款方式</label>
                    <div class="repay-type-options">
                        <label class="repay-type-option">
                            <input type="radio" name="repayType" value="full" checked>
                            <span class="type-btn" data-lang="fullRepay">全额还款</span>
                        </label>
                        <label class="repay-type-option">
                            <input type="radio" name="repayType" value="partial">
                            <span class="type-btn" data-lang="partialRepay">部分还款</span>
                        </label>
                    </div>
                </div>

                <!-- 部分还款金额输入 -->
                <div class="partial-repay-section" id="partialRepaySection" style="display: none;">
                    <label class="repay-amount-label" data-lang="repayAmount">还款金额</label>
                    <div class="repay-amount-input-wrapper">
                        <input type="number" class="repay-amount-input" id="partialRepayAmount" placeholder="0.00" min="0" step="0.01">
                        <span class="repay-amount-suffix">USDT</span>
                    </div>
                    <div class="repay-amount-hints">
                        <button type="button" class="hint-btn" data-percent="25">25%</button>
                        <button type="button" class="hint-btn" data-percent="50">50%</button>
                        <button type="button" class="hint-btn" data-percent="75">75%</button>
                        <button type="button" class="hint-btn" data-percent="100">100%</button>
                    </div>
                    <div class="repay-remaining" id="repayRemaining">
                        <span class="remaining-label" data-lang="remainingDebt">还款后剩余</span>
                        <span class="remaining-value" id="remainingValue">-- USDT</span>
                    </div>
                </div>
                
                <div class="repay-balance">
                    <span class="balance-label" data-lang="walletBalance">钱包余额</span>
                    <span class="balance-value" id="walletBalance">-- USDT</span>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-ghost" id="repayCancel" data-lang="cancel">取消</button>
                <button class="btn btn-primary" id="repayConfirm">
                    <span data-lang="confirmRepay">确认还款</span>
                    <span class="repay-confirm-amount" id="repayConfirmAmount"></span>
                </button>
            </div>
        </div>
    </div>

    <!-- 借款详情弹窗 -->
    <div class="modal" id="detailModal">
        <div class="modal-overlay"></div>
        <div class="modal-content detail-modal">
            <div class="modal-header">
                <div class="detail-header-left">
                    <h3 class="modal-title">借款详情</h3>
                    <span class="detail-loan-id" id="detailLoanId">--</span>
                </div>
                <div class="detail-header-right">
                    <span class="detail-status" id="detailStatus">--</span>
                    <button class="modal-close" id="detailModalClose">×</button>
                </div>
            </div>
            <div class="modal-body">
                <!-- 金额信息 -->
                <div class="detail-section">
                    <h4 class="detail-section-title" data-lang="amountInfo">金额信息</h4>
                    <div class="detail-amount-row">
                        <div class="detail-amount-item">
                            <span class="detail-label" data-lang="principal">借款本金</span>
                            <span class="detail-value" id="detailPrincipal">-- USDT</span>
                        </div>
                        <div class="detail-amount-item highlight">
                            <span class="detail-label" data-lang="totalRepay">应还总额</span>
                            <span class="detail-value" id="detailTotal">-- USDT</span>
                        </div>
                    </div>
                </div>

                <!-- 时间信息 -->
                <div class="detail-section">
                    <h4 class="detail-section-title" data-lang="timeInfo">时间信息</h4>
                    <div class="detail-grid">
                        <div class="detail-item">
                            <span class="detail-label">借款日期</span>
                            <span class="detail-value" id="detailBorrowDate">--</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">到期日期</span>
                            <span class="detail-value" id="detailDueDate">--</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">借款期限</span>
                            <span class="detail-value" id="detailTerm">-- 天</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label" id="detailDaysLabel">剩余天数</span>
                            <span class="detail-value" id="detailDaysValue">--</span>
                        </div>
                    </div>
                </div>

                <!-- 逾期警告 -->
                <div class="overdue-warning" id="overdueWarning" style="display: none;">
                    <div class="warning-icon">!</div>
                    <div class="warning-content">
                        <span class="warning-title">借款已逾期</span>
                        <span class="warning-desc" id="overdueDesc">请尽快还款，逾期将影响您的信用评分</span>
                    </div>
                </div>

                <!-- 交易信息（弱化展示） -->
                <div class="detail-tx-footer">
                    <span class="tx-label" data-lang="txInfo">交易信息</span>
                    <span class="tx-hash-inline" id="detailTxHash">0x1a2b...3c4d</span>
                    <button class="copy-btn-small" id="copyTxHash">复制</button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-ghost" id="detailClose">关闭</button>
                <button class="btn btn-primary" id="detailRepayBtn">立即还款</button>
            </div>
        </div>
    </div>

    <!-- 还款成功弹窗 -->
    <div class="modal" id="successModal">
        <div class="modal-overlay"></div>
        <div class="modal-content success-modal">
            <div class="modal-icon success">✔</div>
            <h3 class="modal-title" data-lang="repaySuccess">还款成功</h3>
            <p class="modal-desc" data-lang="repaySuccessDesc">您已成功还款，感谢您的信任！</p>
            <div class="success-info">
                <div class="info-row">
                    <span data-lang="repayAmount">还款金额</span>
                    <span id="successAmount">-- USDT</span>
                </div>
            </div>
            
            <!-- 激励提示 -->
            <div class="emission-notice">
                <div class="emission-notice-header">
                    <span class="emission-icon">✦</span>
                    <span data-lang="emissionJoined">已加入激励排放池！</span>
                </div>
                <div class="emission-notice-body">
                    <div class="emission-notice-item">
                        <span class="notice-badge daily" data-lang="dailyEmissionReward">每日激励</span>
                        <span class="notice-reward">1,000 LISTA</span>
                    </div>
                    <div class="emission-notice-item">
                        <span class="notice-badge weekly" data-lang="weeklyEmissionReward">每周激励</span>
                        <span class="notice-reward">10,000 LISTA</span>
                    </div>
                </div>
                <div class="emission-notice-footer">
                    <span class="notice-time-icon">⏰</span>
                    <span data-lang="emissionReminder">分配时间：明日 / 下周一 08:00 (UTC)</span>
                </div>
            </div>
            
            <div class="success-actions">
                <a href="rewards.html" class="btn btn-outline" data-lang="viewRewards">查看激励记录</a>
                <button class="btn btn-primary" id="successClose" data-lang="done">完成</button>
            </div>
        </div>
    </div>

    <script src="lang.js"></script>
    <script src="dashboard.js"></script>
</body>
</html>
